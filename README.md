# D-Wave Ising Sample Collector (D-WISC)

The D-WISC toolset is used to collect larger numbers of samples, on the order of millions, from a specific D-Wave QPU.  The `dwisc.py` collection script takes a [bqpjson](http://bqpjson.readthedocs.io/en/stable/) file as input (typically generated by [D-WIG](https://github.com/lanl-ansi/dwig)) and outputs a _solution_ json document that provides detailing the collected samples.  The helper script `combis.py` can be used to combine many _solution_ documents from repeated runs of `dwisc.py`.

The remainder of this documentation assumes that,

1. You have access to a D-Wave QPU and the SAPI binaries
2. You are using a bash terminal

### Basic Usage

The primary entry point of the D-WISC toolset is `dwisc.py` this script is used to collect samples from a D-Wave QPU.  For example, the following command will collect 25000 samples of from the bqpjson file `ran1_1.json` and send the resulting sample data to standard output,
```
./dwisc.py -f test/data/ran1_1.json 
```
Bash stream redirection can be used to save the standard output to a file, for example,
```
./dwisc.py -f test/data/ran1_1.json > ran1_1_is_1.json
```
A detailed list of all command line options can be viewed via,
```
./dwisc.py --help
```

It is fairly common to combine results from several runs of `dwisc.py`.  If multiple sample files are placed in a directory, `combis.py` can be used to quickly combine those files and send the resulting sample data to standard output,
```
./combis.py -sd test/result
```
Again, bash stream redirection can be used to save the standard output to a file, for example,
```
./combis.py -sd test/result > result.json
```

### Connecting to a QPU

At this time D-WISC cannot work without a QPU connection.  The simplest way to add connection details is via the following command line arguments,
```
./dwisc.py 
    -url <d-wave endpoint url>
    -token <sapi token>
    -solver <solver name>
    ran
```

Alternatively, a `_config` file can be placed in the D-WISC directory of the following form,
```
{
    "dw_url":"<d-wave endpoint url>",
    "dw_token":"<sapi token>",
    "dw_solver_name":"<solver name>"
}
```
The configuration file is a json document that can be use to set default values for all command line parameters.

If no connection details are provided, D-WISC will attempt use any connection details provided in the bqpjson file.  

### Solution JSON File

The solution file output by D-WISC is a JSON document with has the following structure,
```
{
  "collection_start": "<UTC start time of sample collection>",
  "collection_end": "<UTC end time of sample collection>",
  "metadata": {<QPU identification data>},
  "solve_ising_args": {<arguments passed to solve_ising>},
  "timing": {<QPU timing information>}
  "variable_ids": [<an ordered list of QPU variable ids>],
  "solutions":[
    {
      "solution":[<variable assignments of -1 and 1>],
      "num_occurrences":<int>,
      "energy":<float>
    },
    ...
  ]
}
```
The `metadata` and `solve_ising_args` fields are optional, all other fields are required.

## License
D-WISC is provided under a BSD-ish license with a "modifications must be indicated" clause.  See the `LICENSE.md` file for the full text.
This package is part of the Hybrid Quantum-Classical Computing suite, known internally as LA-CC-16-032.
